<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=utf-8">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:新細明體;
	panose-1:2 2 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:"Calibri Light";
	panose-1:2 15 3 2 2 2 4 3 2 4;}
@font-face
	{font-family:Consolas;
	panose-1:2 11 6 9 2 2 4 3 2 4;}
@font-face
	{font-family:"\@新細明體";
	panose-1:2 1 6 1 0 1 1 1 1 1;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{margin:0cm;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;}
a:link, span.MsoHyperlink
	{color:#0563C1;
	text-decoration:underline;}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:24.0pt;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoTocHeading, li.MsoTocHeading, div.MsoTocHeading
	{margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	line-height:107%;
	page-break-after:avoid;
	font-size:16.0pt;
	font-family:"Calibri Light",sans-serif;
	color:#2F5496;}
.MsoChpDefault
	{font-family:"Calibri",sans-serif;}
 /* Page Definitions */
 @page WordSection1
	{size:595.3pt 841.9pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;
	layout-grid:18.0pt;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>

</head>

<body lang=ZH-TW link="#0563C1" vlink="#954F72" style='word-wrap:break-word;
text-justify-trim:punctuation'>

<div class=WordSection1 style='layout-grid:18.0pt'>

<p class=MsoNormal align=center style='text-align:center'><span lang=EN-US
style='font-size:20.0pt'>Pi</span><span style='font-size:20.0pt;font-family:
"新細明體",serif'>節點說明</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoTocHeading><span style='font-size:20.0pt;line-height:107%;
font-family:"新細明體",serif;color:windowtext'>目錄</span></p>

<p class=MsoToc1><span lang=EN-US><span class=MsoHyperlink><a
href="#_Toc111928215"><span lang=EN-US style='font-family:"新細明體",serif'><span
lang=EN-US>一、節點是什麼？</span></span><span style='color:windowtext;display:none;
text-decoration:none'>... </span><span
style='color:windowtext;display:none;text-decoration:none'>2</span></a></span></span></p>

<p class=MsoToc1><span class=MsoHyperlink><span lang=EN-US><a
href="#_Toc111928216"><span lang=EN-US style='font-family:"新細明體",serif'><span
lang=EN-US>二、裝了什麼東西？</span></span><span style='color:windowtext;display:none;
text-decoration:none'>... </span><span
style='color:windowtext;display:none;text-decoration:none'>5</span></a></span></span></p>

<p class=MsoToc1><span class=MsoHyperlink><span lang=EN-US><a
href="#_Toc111928217"><span lang=EN-US style='font-family:"新細明體",serif'><span
lang=EN-US>三、節點與其他虛擬系統</span></span><span style='color:windowtext;display:none;
text-decoration:none'>... </span><span
style='color:windowtext;display:none;text-decoration:none'>6</span></a></span></span></p>

<p class=MsoToc1><span class=MsoHyperlink><span lang=EN-US><a
href="#_Toc111928218"><span lang=EN-US style='font-family:"新細明體",serif'><span
lang=EN-US>四、</span></span>API Services<span lang=EN-US style='font-family:
"新細明體",serif'><span lang=EN-US>是什麼？</span></span><span style='color:windowtext;
display:none;text-decoration:none'>... </span><span
style='color:windowtext;display:none;text-decoration:none'>8</span></a></span></span></p>

<p class=MsoToc1><span class=MsoHyperlink><span lang=EN-US><a
href="#_Toc111928219"><span lang=EN-US style='font-family:"新細明體",serif'><span
lang=EN-US>五、如何查看節點狀況？</span></span><span style='color:windowtext;display:none;
text-decoration:none'>... </span><span
style='color:windowtext;display:none;text-decoration:none'>10</span></a></span></span></p>

<p class=MsoToc1><span class=MsoHyperlink><span lang=EN-US><a
href="#_Toc111928220"><span lang=EN-US style='font-family:"新細明體",serif'><span
lang=EN-US>六、超節需要固定</span></span>IP<span lang=EN-US style='font-family:"新細明體",serif'><span
lang=EN-US>嗎？</span></span><span style='color:windowtext;display:none;
text-decoration:none'>... </span><span
style='color:windowtext;display:none;text-decoration:none'>15</span></a></span></span></p>

<p class=MsoToc1><span class=MsoHyperlink><span lang=EN-US><a
href="#_Toc111928221"><span lang=EN-US style='font-family:"新細明體",serif'><span
lang=EN-US>七、為什麼開啟</span></span>API<span lang=EN-US style='font-family:"新細明體",serif'><span
lang=EN-US>之後，本地區塊跟不上同步？</span></span><span style='color:windowtext;display:
none;text-decoration:none'>... </span><span
style='color:windowtext;display:none;text-decoration:none'>17</span></a></span></span></p>

<p class=MsoToc1><span class=MsoHyperlink><span lang=EN-US><a
href="#_Toc111928222"><span lang=EN-US style='font-family:"新細明體",serif'><span
lang=EN-US>八、更改時區</span></span><span style='color:windowtext;display:none;
text-decoration:none'>... </span><span
style='color:windowtext;display:none;text-decoration:none'>18</span></a></span></span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<span lang=EN-US style='font-size:12.0pt;font-family:"Calibri",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><a name="_Toc111928215"><span style='font-size:20.0pt;
font-family:"新細明體",serif'>一、節點是什麼？</span></a></p>

<p class=MsoNormal><span lang=EN-US>Pi Network</span><span style='font-family:
"新細明體",serif'>及目前大家看到的公有區塊鏈都是去中心化、分散式的系統，它的運算、儲存都是仰賴全球成千上萬的機器，我們稱之為節點</span><span
lang=EN-US>(</span><span style='font-family:"新細明體",serif'>不過在封閉式主網的階段，</span><span
lang=EN-US>Pi Network</span><span style='font-family:"新細明體",serif'>仍是中心化，因為官方掌控了所有的節點</span><span
lang=EN-US>)</span><span style='font-family:"新細明體",serif'>。</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span style='font-family:"新細明體",serif'>比較一下白皮書中對於節點的描述，超級節點</span><span
lang=EN-US>(Super Node)</span><span style='font-family:"新細明體",serif'>跟節點</span><span
lang=EN-US>(Node)</span><span style='font-family:"新細明體",serif'>的差異在於超級節點參與共識，所以超級節點就是</span><span
lang=EN-US>SCP</span><span style='font-family:"新細明體",serif'>裡面的</span><span
lang=EN-US>Validador</span><span style='font-family:"新細明體",serif'>，節點就是</span><span
lang=EN-US>Watcher</span><span style='font-family:"新細明體",serif'>。</span></p>

<p class=MsoNormal><span lang=EN-US><img width=554 height=405 id="圖片 12"
src="aboutnode.files/image001.jpg"></span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US><img width=554 height=366 id="圖片 13"
src="aboutnode.files/image002.jpg"></span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span style='font-family:"新細明體",serif'>這裡額外提一下，</span><span
lang=EN-US>Pi</span><span style='font-family:"新細明體",serif'>節點並不是用來「挖礦」的，</span><span
lang=EN-US>Pi Network</span><span style='font-family:"新細明體",serif'>也不是用手機挖礦。所謂的「手機挖礦」只是「行銷話術」，因為比特幣是全世界第一個加密貨幣，「挖礦」一詞也是出自於比特幣，講「手機挖礦」只是為了吸引人們的注意力，也讓大眾更容易理解。</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span style='font-family:"新細明體",serif'>我們來看比特幣是怎麼「鑄造」出來的？比特幣大約每十分鐘產生一個新的區塊，如果觀察區塊的內容</span><span
lang=EN-US>(</span><span style='font-family:"新細明體",serif'>例如</span> <span
lang=EN-US><a
href="https://www.blockchain.com/btc/block/000000000000000000063091dccd48774d7f0f02714d850bc96e4cefd8e8c612">https://www.blockchain.com/btc/block/000000000000000000063091dccd48774d7f0f02714d850bc96e4cefd8e8c612</a>
)</span><span style='font-family:"新細明體",serif'>，會發現每一個區塊都有</span><span
lang=EN-US>Miner</span><span style='font-family:"新細明體",serif'>，也就是產生這個區塊的人，而區塊中的第一筆交易就是產生新的比特幣給</span><span
lang=EN-US>Miner</span><span style='font-family:"新細明體",serif'>。因為有這樣的誘因，所以大家才會搶著挖礦。</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>Pi</span><span style='font-family:"新細明體",serif'>幣的總量是</span><span
lang=EN-US>1000</span><span style='font-family:"新細明體",serif'>億，其中</span><span
lang=EN-US>650</span><span style='font-family:"新細明體",serif'>億分配給全世界的先鋒</span><span
lang=EN-US>(</span><span style='font-family:"新細明體",serif'>就是我們啦</span><span
lang=EN-US>)</span><span style='font-family:"新細明體",serif'>。這些</span><span
lang=EN-US>Pi</span><span style='font-family:"新細明體",serif'>幣已經在</span><span
lang=EN-US>2021/12/29</span><span style='font-family:"新細明體",serif'>鑄造出來了，存放在</span><span
lang=EN-US>GBQQ</span><span style='font-family:"新細明體",serif'>這個錢包內</span><span
lang=EN-US>(</span><span style='font-family:"新細明體",serif'>同樣可以在主網區塊鏈查到</span> <span
lang=EN-US><a href="https://minepi.com/blockexplorer/block/445170">https://minepi.com/blockexplorer/block/445170</a>
)</span><span style='font-family:"新細明體",serif'>。因為沒有大家搶著要「鑄幣」的「挖礦」過程，也就不會落入無止盡的礦機軍備競賽。</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span style='font-family:"新細明體",serif'>我們每天按閃電，就跟麥當勞</span><span
lang=EN-US>APP</span><span style='font-family:"新細明體",serif'>簽到賺積分、蝦皮</span><span
lang=EN-US>APP</span><span style='font-family:"新細明體",serif'>簽到集蝦幣是一樣的。這樣的行為一方面是確定我們是真人，另一方面是要維持先鋒的黏著度。它們都跟區塊鏈沒有任何關係，都不是去中心化，只是在官方資料庫中的一個點數。</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>BUT</span><span style='font-family:"新細明體",serif'>！但是！一旦我們通過</span><span
lang=EN-US>Pi Network</span><span style='font-family:"新細明體",serif'>的</span><span
lang=EN-US>KYC(</span><span style='font-family:"新細明體",serif'>身分驗證</span><span
lang=EN-US>)</span><span style='font-family:"新細明體",serif'>，有一個遷移主網的動作，讓</span><span
lang=EN-US>GBQQ</span><span style='font-family:"新細明體",serif'>錢包</span><span
lang=EN-US>(</span><span style='font-family:"新細明體",serif'>更準確地說是</span><span
lang=EN-US>GABT</span><span style='font-family:"新細明體",serif'>錢包，由它來建立先鋒的錢包，以及鎖倉</span><span
lang=EN-US>)</span><span style='font-family:"新細明體",serif'>的</span><span
lang=EN-US>Pi</span><span style='font-family:"新細明體",serif'>幣轉到我們在</span><span
lang=EN-US>Pi Network</span><span style='font-family:"新細明體",serif'>主網的錢包內，到時候就是真正的區塊鏈技術、加密貨幣、去中心化。</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span style='font-family:"新細明體",serif'>所以如果你能理解麥當勞</span><span
lang=EN-US>APP</span><span style='font-family:"新細明體",serif'>簽到賺積分這件事，就應該也理解</span><span
lang=EN-US>Pi Network</span><span style='font-family:"新細明體",serif'>點閃電就能挖</span><span
lang=EN-US>Pi</span><span style='font-family:"新細明體",serif'>。差別在於麥當勞的積分只能讓你吃一頓漢堡，而</span><span
lang=EN-US>Pi</span><span style='font-family:"新細明體",serif'>有機會成為全球最廣泛流通使用的加密貨幣。</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<span lang=EN-US style='font-size:12.0pt;font-family:"Calibri",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><a name="_Toc111928216"><span style='font-size:20.0pt;
font-family:"新細明體",serif'>二、裝了什麼東西？</span></a></p>

<p class=MsoNormal><span lang=EN-US>Pi</span><span style='font-family:"新細明體",serif'>節點要安裝兩個軟體：</span><span
lang=EN-US>Pi Node Software</span><span style='font-family:"新細明體",serif'>與</span><span
lang=EN-US>Docker Desktop</span><span style='font-family:"新細明體",serif'>。</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>Pi Node Software</span><span
style='font-family:"新細明體",serif'>綁定了</span><span lang=EN-US>Pi</span><span
style='font-family:"新細明體",serif'>帳號，讓你在電腦上也可以使用手機</span><span lang=EN-US>APP</span><span
style='font-family:"新細明體",serif'>的部分功能</span><span lang=EN-US>(</span><span
style='font-family:"新細明體",serif'>只能在手機</span><span lang=EN-US>APP</span><span
style='font-family:"新細明體",serif'>點閃電</span><span lang=EN-US>)</span><span
style='font-family:"新細明體",serif'>，以及在網路上能識別這台節點是屬於哪個</span><span lang=EN-US>Pi</span><span
style='font-family:"新細明體",serif'>帳號，以利計算獎勵。還有一個很重要的功能：讓你很容易的執行</span><span
lang=EN-US>Stellar Core</span><span style='font-family:"新細明體",serif'>。</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>Stellar Core</span><span style='font-family:
"新細明體",serif'>又是什麼？</span><span lang=EN-US>Pi Network</span><span
style='font-family:"新細明體",serif'>採用的共識協議是「恆星共識協議</span><span lang=EN-US>
(Stellar Consensus Protocol, SCP)</span><span style='font-family:"新細明體",serif'>」，</span><span
lang=EN-US>SCP</span><span style='font-family:"新細明體",serif'>的節點程式就叫做</span><span
lang=EN-US style='color:red'>Stellar Core</span><span style='font-family:"新細明體",serif'>。</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span style='font-family:"新細明體",serif'>因為不是每個人都有足夠的技術能力可以自行安裝與設定</span><span
lang=EN-US>Stellar Core</span><span style='font-family:"新細明體",serif'>，所以</span><span
lang=EN-US>Pi</span><span style='font-family:"新細明體",serif'>核心團隊想了一個辦法，將相關的程式與設定都打包好，做成一個</span><span
lang=EN-US>image</span><span style='font-family:"新細明體",serif'>檔，只要安裝了</span><span
lang=EN-US>Docker Desktop</span><span style='font-family:"新細明體",serif'>這個虛擬化軟體，就能執行。</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>Docker Desktop</span><span
style='font-family:"新細明體",serif'>是一個虛擬化軟體，它載入</span><span lang=EN-US>image</span><span
style='font-family:"新細明體",serif'>檔，建立一個</span><span lang=EN-US>Container(</span><span
style='font-family:"新細明體",serif'>容器</span><span lang=EN-US>)</span><span
style='font-family:"新細明體",serif'>。</span><span lang=EN-US>Container</span><span
style='font-family:"新細明體",serif'>就是一個執行的應用程式</span><span lang=EN-US>(</span><span
style='font-family:"新細明體",serif'>此例是</span><span lang=EN-US>Stellar Core)</span><span
style='font-family:"新細明體",serif'>加上執行它的簡易版</span><span lang=EN-US>Linux</span><span
style='font-family:"新細明體",serif'>環境</span><span lang=EN-US>(</span><span
style='font-family:"新細明體",serif'>包括</span><span lang=EN-US>root</span><span
style='font-family:"新細明體",serif'>使用者權限、程式空間、使用者空間和網路空間等</span><span lang=EN-US>)</span><span
style='font-family:"新細明體",serif'>。</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span style='font-family:"新細明體",serif'>所以</span><span
lang=EN-US>Pi Node Software</span><span style='font-family:"新細明體",serif'>也管理了</span><span
lang=EN-US>Docker Desktop</span><span style='font-family:"新細明體",serif'>部分功能，讓一切都變得只要會按「下一步」就好了。</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<span lang=EN-US style='font-size:12.0pt;font-family:"Calibri",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><a name="_Toc111928217"><span style='font-size:20.0pt;
font-family:"新細明體",serif'>三、節點與其他虛擬系統</span></a></p>

<p class=MsoNormal><span lang=EN-US>Pi</span><span style='font-family:"新細明體",serif'>節點需要安裝</span><span
lang=EN-US>Docker</span><span style='font-family:"新細明體",serif'>，</span><span
lang=EN-US>Docker</span><span style='font-family:"新細明體",serif'>需要安裝</span><span
lang=EN-US>WSL 2 (Windows Subsystem for Linux 2)</span><span style='font-family:
"新細明體",serif'>，</span><span lang=EN-US>WSL</span><span style='font-family:"新細明體",serif'>會使用</span><span
lang=EN-US>Hyper-V</span><span style='font-family:"新細明體",serif'>架構來啟用其虛擬化。此架構將在「虛擬機器平台」選用元件中提供。</span></p>

<p class=MsoNormal><span lang=EN-US><img border=0 width=415 height=368 id="圖片 4"
src="aboutnode.files/image003.png"></span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span style='font-family:"新細明體",serif'>但是這又會遇到一個“致命”問題，那就是</span><span
lang=EN-US>Hyper-V</span><span style='font-family:"新細明體",serif'>不能與</span><span
lang=EN-US>VirtualBox</span><span style='font-family:"新細明體",serif'>和</span><span
lang=EN-US>VMware</span><span style='font-family:"新細明體",serif'>共存。原因是</span><span
lang=EN-US>Hyper-V</span><span style='font-family:"新細明體",serif'>的虛擬方式不一樣，開啟</span><span
lang=EN-US>Hyper-V</span><span style='font-family:"新細明體",serif'>後會將使用者的桌面系統給虛擬化，使用者的桌面系統就會成為</span><span
lang=EN-US>Hyper-V</span><span style='font-family:"新細明體",serif'>的虛擬系統，而</span><span
lang=EN-US>Hyper-V</span><span style='font-family:"新細明體",serif'>的虛擬系統是不允許再開虛擬機器的，因此開啟</span><span
lang=EN-US>Hyper-V</span><span style='font-family:"新細明體",serif'>後</span><span
lang=EN-US>VirtualBox</span><span style='font-family:"新細明體",serif'>和</span><span
lang=EN-US>VMware</span><span style='font-family:"新細明體",serif'>就不能執行。其他手機模擬器也是相同原因。</span></p>

<p class=MsoNormal><span lang=EN-US><img border=0 width=554 height=361 id="圖片 2"
src="aboutnode.files/image004.jpg" alt=虚拟方式></span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>VirtualBox 6</span><span style='font-family:
"新細明體",serif'>中新增了利用</span><span lang=EN-US>Hyper-V</span><span
style='font-family:"新細明體",serif'>的</span><span lang=EN-US>API</span><span
style='font-family:"新細明體",serif'>進行虛擬化系統，由於這個功能還是實驗性的功能，所以沒有現成的</span><span
lang=EN-US>GUI</span><span style='font-family:"新細明體",serif'>按鈕或介面開啟這個功能，需要使用命令列開啟。</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>#</span><span style='font-family:"新細明體",serif'>指定</span><span
lang=EN-US>VirtualBox</span><span style='font-family:"新細明體",serif'>下的虛擬系統開啟這個功能</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:Consolas;color:black;
background:#D9D9D9'>VBoxManage setextradata &quot;&lt;</span><span
style='font-family:"新細明體",serif;color:black;background:#D9D9D9'>虛擬機器名字</span><span
lang=EN-US style='font-family:Consolas;color:black;background:#D9D9D9'>&gt;&quot;
&quot;VBoxInternal/NEM/UseRing0Runloop&quot; 0</span></p>

<p class=MsoNormal><span lang=EN-US> </span></p>

<p class=MsoNormal><span lang=EN-US>#</span><span style='font-family:"新細明體",serif'>或指定</span><span
lang=EN-US>VirtualBox</span><span style='font-family:"新細明體",serif'>所有虛擬系統開啟</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:Consolas;color:black;
background:#D9D9D9'>VBoxManage setextradata global &quot;VBoxInternal/NEM/UseRing0Runloop&quot;
0</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span style='font-family:"新細明體",serif'>但經我實測，</span><span
lang=EN-US>VirtualBox 6.1.32</span><span style='font-family:"新細明體",serif'>雖然可以執行，效能也會大打折扣。至於</span><span
lang=EN-US>VMware</span><span style='font-family:"新細明體",serif'>跟手機模擬器我就沒測試了。</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<span lang=EN-US style='font-size:12.0pt;font-family:"Calibri",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><a name="_Toc111928218"><span style='font-size:20.0pt;
font-family:"新細明體",serif'>四、</span></a><span lang=EN-US style='font-size:20.0pt'>API
Services</span><span style='font-size:20.0pt;font-family:"新細明體",serif'>是什麼？</span><span
style='font-size:20.0pt'> </span></p>

<p class=MsoNormal><span lang=EN-US><img border=0 width=554 height=675 id="圖片 1"
src="aboutnode.files/image005.jpg"></span></p>

<p class=MsoNormal><span style='font-family:"新細明體",serif'>這是什麼？它告訴我們這是個選項，可有可無？可以透過</span><span
lang=EN-US>port 31401</span><span style='font-family:"新細明體",serif'>、</span><span
lang=EN-US>http</span><span style='font-family:"新細明體",serif'>的方式跟區塊鏈互動？啟用後會消耗大量的磁碟空間？</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>Pi</span><span style='font-family:"新細明體",serif'>節點程式的</span><span
lang=EN-US>API Services</span><span style='font-family:"新細明體",serif'>就是「</span><span
lang=EN-US>Horizon API</span><span style='font-family:"新細明體",serif'>」。</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>Horizon</span><span style='font-family:
"新細明體",serif'>是一個</span><span lang=EN-US>RESTful API</span><span
style='font-family:"新細明體",serif'>，可以讓人們輕鬆地透過</span><span lang=EN-US>http</span><span
style='font-family:"新細明體",serif'>跟</span><span lang=EN-US>Stellar Core</span><span
style='font-family:"新細明體",serif'>溝通，而不必擔心底層細節，也不用懂得</span><span lang=EN-US>Stellar
SDK</span><span style='font-family:"新細明體",serif'>。所以如果節點沒有開</span><span
lang=EN-US>port</span><span style='font-family:"新細明體",serif'>，啟用</span><span
lang=EN-US>API Services</span><span style='font-family:"新細明體",serif'>就沒意義，因為外部連不進來。除非你自己會寫程式，要在本機提交交易。</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span style='font-family:"新細明體",serif'>它可以讓你做到：</span></p>

<p class=MsoListParagraph style='margin-left:24.0pt;text-indent:-24.0pt'><span
lang=EN-US style='font-family:Wingdings'>l<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span><span style='font-family:"新細明體",serif'>向網路提交交易</span></p>

<p class=MsoListParagraph style='margin-left:24.0pt;text-indent:-24.0pt'><span
lang=EN-US style='font-family:Wingdings'>l<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span><span style='font-family:"新細明體",serif'>讀取有關區塊當前狀態的訊息（如帳戶餘額）</span></p>

<p class=MsoListParagraph style='margin-left:24.0pt;text-indent:-24.0pt'><span
lang=EN-US style='font-family:Wingdings'>l<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span><span style='font-family:"新細明體",serif'>探索歷史資料（例如賬戶之前提交給網路的交易）</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoListParagraph style='margin-left:24.0pt;text-indent:-24.0pt'><span
lang=EN-US style='font-family:Wingdings'>²<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span><span style='font-family:"新細明體",serif'>為什麼需要</span><span
lang=EN-US>Horizon</span><span style='font-family:"新細明體",serif'>呢？</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>Stellar Core</span><span style='font-family:
"新細明體",serif'>著重的是驗證交易並維護「當前」區塊的狀況，並未針對查詢最佳化。它使用的</span><span lang=EN-US>XDR</span><span
style='font-family:"新細明體",serif'>檔難以閱讀，且缺乏有用的索引，因此很難查找。未優化的查詢實際上會減慢節點的速度，在最壞的情況下，這可能會導致它失去共識。</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>Horizon</span><span style='font-family:
"新細明體",serif'>旨在允許開發人員提交交易並有效地使用網路資料。它從</span><span lang=EN-US>Stellar Core</span><span
style='font-family:"新細明體",serif'>獲取</span><span lang=EN-US>XDR</span><span
style='font-family:"新細明體",serif'>資料並將其解碼為更容易使用的</span><span lang=EN-US>JSON</span><span
style='font-family:"新細明體",serif'>，讓閱讀區塊的當前狀態或探索歷史資料變得容易。同時讓</span><span
lang=EN-US>Stellar Core</span><span style='font-family:"新細明體",serif'>可以專注於共識的工作。</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoListParagraph style='margin-left:24.0pt;text-indent:-24.0pt'><span
lang=EN-US style='font-family:Wingdings'>²<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span><span style='font-family:"新細明體",serif'>為什麼執行</span><span
lang=EN-US>Horizon</span><span style='font-family:"新細明體",serif'>會消耗大量的磁碟空間？</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>Horizon</span><span style='font-family:
"新細明體",serif'>從</span><span lang=EN-US>Stellar Core</span><span
style='font-family:"新細明體",serif'>讀取資料，將其處理成「</span><span lang=EN-US>transaction
metadata</span><span style='font-family:"新細明體",serif'>」</span><span lang=EN-US>(</span><span
style='font-family:"新細明體",serif'>例如</span><span lang=EN-US>balance history</span><span
style='font-family:"新細明體",serif'>、</span><span lang=EN-US>account effects</span><span
style='font-family:"新細明體",serif'>等資料依照時間序列處理</span><span lang=EN-US>)</span><span
style='font-family:"新細明體",serif'>，然後儲存在</span><span lang=EN-US>Horizon DB(</span><span
style='font-family:"新細明體",serif'>使用</span><span lang=EN-US>PostgreSQL</span><span
style='font-family:"新細明體",serif'>資料庫</span><span lang=EN-US>)</span><span
style='font-family:"新細明體",serif'>，所以會消耗磁碟空間。</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span style='font-family:"新細明體",serif'>隨著時間的推移，歷史紀錄不斷累積，從而增加資料庫使用的存儲空間。可以使用</span><span
lang=EN-US>--history-retention-count flag</span><span style='font-family:"新細明體",serif'>或</span><span
lang=EN-US>HISTORY_RETENTION_COUNT</span><span style='font-family:"新細明體",serif'>環境變數來設定希望保留的區塊數量，但是</span><span
lang=EN-US>Pi</span><span style='font-family:"新細明體",serif'>沒有設定，所以會無限增長。</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span style='font-family:"新細明體",serif'>結論，到底要不要執行</span><span
lang=EN-US>Horizon</span><span style='font-family:"新細明體",serif'>？我的建議是看個人，如果你的節點有開</span><span
lang=EN-US>port</span><span style='font-family:"新細明體",serif'>、磁碟空間足夠，想對整個</span><span
lang=EN-US>Pi Network</span><span style='font-family:"新細明體",serif'>多盡一份力，那就執行吧。但是有些人發現執行</span><span
lang=EN-US>Horizon</span><span style='font-family:"新細明體",serif'>之後，本地區塊常跟不上同步，這部分在後面討論。</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<span lang=EN-US style='font-size:12.0pt;font-family:"Calibri",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><a name="_Toc111928219"><span style='font-size:20.0pt;
font-family:"新細明體",serif'>五、如何查看節點狀況？</span></a></p>

<p class=MsoNormal><span style='font-family:"新細明體",serif'>我不喜歡看</span><span
lang=EN-US>Pi Node Software</span><span style='font-family:"新細明體",serif'>的畫面，因為資料有所延遲，它沒有即時刷新。而且我平時都把</span><span
lang=EN-US>Pi Node Software</span><span style='font-family:"新細明體",serif'>及</span><span
lang=EN-US>Docker Desktop</span><span style='font-family:"新細明體",serif'>的視窗關掉，讓它們在背景執行。</span></p>

<p class=MsoNormal><span lang=EN-US><img border=0 width=463 height=172 id="圖片 3"
src="aboutnode.files/image006.jpg"></span></p>

<p class=MsoNormal><span lang=EN-US><img border=0 width=236 height=147 id="圖片 5"
src="aboutnode.files/image007.jpg"></span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span style='font-family:"新細明體",serif'>我會直接以</span><span
lang=EN-US>Stellar Core</span><span style='font-family:"新細明體",serif'>指令來查詢，請先開啟</span><span
lang=EN-US>Docker Command Line Interface (CLI)</span></p>

<p class=MsoNormal><span lang=EN-US><img border=0 width=553 height=178 id="圖片 6"
src="aboutnode.files/image008.jpg"></span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span style='font-family:"新細明體",serif'>或在命令提示字元輸入</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:Consolas;color:black;
background:#D9D9D9'>docker exec -it pi-consensus bash</span></p>

<p class=MsoNormal><span lang=EN-US><img border=0 width=554 height=123 id="圖片 8"
src="aboutnode.files/image009.jpg"></span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoListParagraph style='margin-left:24.0pt;text-indent:-24.0pt'><span
lang=EN-US style='font-family:Wingdings'>²<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span><span style='font-family:"新細明體",serif'>查看節點資訊</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:Consolas;color:black;
background:#D9D9D9'>stellar-core http-command info</span></p>

<p class=MsoNormal><span lang=EN-US><img border=0 width=553 height=658
id="圖片 10" src="aboutnode.files/image010.jpg"></span></p>

<p class=MsoNormal><span style='font-family:"新細明體",serif'>重點是看本地跟仲裁集的區塊編號，還有</span><span
lang=EN-US>age</span><span style='font-family:"新細明體",serif'>秒數，就知道你的區塊落後多少。</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoListParagraph style='margin-left:24.0pt;text-indent:-24.0pt'><span
lang=EN-US style='font-family:Wingdings'>²<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span><span style='font-family:"新細明體",serif'>點對點的連線結果</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:Consolas;color:black;
background:#D9D9D9'>stellar-core http-command peers</span></p>

<p class=MsoNormal><span lang=EN-US><img border=0 width=347 height=929
id="圖片 11" src="aboutnode.files/image011.jpg"></span></p>

<p class=MsoNormal><span style='font-family:"新細明體",serif'>這裡要說明一下，常有人認為</span><span
lang=EN-US>Incoming connections</span><span style='font-family:"新細明體",serif'>要大於</span><span
lang=EN-US>0</span><span style='font-family:"新細明體",serif'>才正常，或是看到數字就很嗨，覺得自己的節點很了不起，有</span><span
lang=EN-US>Support</span><span style='font-family:"新細明體",serif'>其他節點，或是認為官方在做壓力測試。其實並‧不‧是！</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>SCP</span><span style='font-family:"新細明體",serif'>是點對點</span><span
lang=EN-US>(peer-to-peer)</span><span style='font-family:"新細明體",serif'>協議，節點之間本來就是會互相連接。如果你用過</span><span
lang=EN-US>BT</span><span style='font-family:"新細明體",serif'>，就知道我講什麼。</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span style='font-family:"新細明體",serif;background:yellow'>更詳細的說明，請看另一篇文章：</span></p>

<p class=MsoNormal><span lang=EN-US><a
href="https://yuanrui919.github.io/io/io.htm"><span style='background:yellow'>https://yuanrui919.github.io/io/io.htm</span></a></span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoListParagraph style='margin-left:24.0pt;text-indent:-24.0pt'><span
lang=EN-US style='font-family:Wingdings'>²<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span><span style='font-family:"新細明體",serif'>不想每次都打指令的人，乾脆做一個批次檔，以後只要點兩下滑鼠就好：</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:Consolas;color:black;
background:#D9D9D9'>docker exec -it pi-consensus stellar-core http-command info</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:Consolas;color:black;
background:#D9D9D9'>pause</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoListParagraph style='margin-left:24.0pt;text-indent:-24.0pt'><span
lang=EN-US style='font-family:Wingdings'>²<span style='font:7.0pt "Times New Roman"'>&nbsp;
</span></span><span style='font-family:"新細明體",serif'>如果要從</span><span
lang=EN-US>log</span><span style='font-family:"新細明體",serif'>查區塊不同步的紀錄，可以用</span><span
lang=EN-US>PowerShell</span><span style='font-family:"新細明體",serif'>執行以下指令：</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:Consolas;color:black;
background:#D9D9D9'>Select-String -pattern &quot;Lost sync|LM_CATCHING_UP_STATE
-&gt; LM_SYNCED_STATE&quot; $env:APPDATA\&quot;Pi
Network&quot;\docker_volumes\supervisor_logs\stellar-core-stdout---supervisor-*.log
| select-object -ExpandProperty Line</span></p>

<p class=MsoNormal><span lang=EN-US><img border=0 width=554 height=316 id="圖片 7"
src="aboutnode.files/image012.jpg"></span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<span lang=EN-US style='font-size:12.0pt;font-family:"Calibri",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><a name="_Toc111928220"><span style='font-size:20.0pt;
font-family:"新細明體",serif'>六、超節需要固定</span></a><span lang=EN-US style='font-size:
20.0pt'>IP</span><span style='font-size:20.0pt;font-family:"新細明體",serif'>嗎？</span></p>

<p class=MsoNormal><span style='font-family:"新細明體",serif'>白皮書對於超節的要求只有穩定地在線以及<span
style='color:red'>開通</span></span><span lang=EN-US style='color:red'>port</span><span
style='font-family:"新細明體",serif'>。結案！</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span style='font-family:"新細明體",serif'>但是固定</span><span
lang=EN-US>IP</span><span style='font-family:"新細明體",serif'>有沒有好處？回答這個問題之前，要先了解「共識」如何產生。</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>SCP</span><span style='font-family:"新細明體",serif'>透過</span><span
lang=EN-US>Validator</span><span style='font-family:"新細明體",serif'>的投票來達成共識，在配置</span><span
lang=EN-US>Stellar Core</span><span style='font-family:"新細明體",serif'>時，必須設定一組仲裁集</span><span
lang=EN-US>(Quorum Set)</span><span style='font-family:"新細明體",serif'>，裡面包含</span><span
lang=EN-US>Validator</span><span style='font-family:"新細明體",serif'>的</span><span
lang=EN-US>domain name</span><span style='font-family:"新細明體",serif'>或</span><span
lang=EN-US>IP</span><span style='font-family:"新細明體",serif'>，以及公鑰</span><span
lang=EN-US>(public key)</span><span style='font-family:"新細明體",serif'>。如果你自己的節點也要成為</span><span
lang=EN-US>Validator</span><span style='font-family:"新細明體",serif'>，除了必須填寫</span><span
lang=EN-US>NODE_SEED</span><span style='font-family:"新細明體",serif'>參數、將</span><span
lang=EN-US>NODE_IS_VALIDATOR</span><span style='font-family:"新細明體",serif'>改成</span><span
lang=EN-US>true</span><span style='font-family:"新細明體",serif'>，還要發布你的</span><span
lang=EN-US>public key</span><span style='font-family:"新細明體",serif'>，讓其他人能加進</span><span
lang=EN-US>QUORUM_SET</span><span style='font-family:"新細明體",serif'>裡。</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span style='font-family:"新細明體",serif'>但是</span><span
lang=EN-US>Pi</span><span style='font-family:"新細明體",serif'>節點不是這麼做，原因有二：</span></p>

<p class=MsoListParagraph style='margin-left:18.0pt;text-indent:-18.0pt'><span
lang=EN-US>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-US>Pi</span><span style='font-family:"新細明體",serif'>節點不完全去中心化，它還綁定了</span><span
lang=EN-US>Pi</span><span style='font-family:"新細明體",serif'>帳號，必須是通過</span><span
lang=EN-US>KYC</span><span style='font-family:"新細明體",serif'>的真人，且由官方核准。不像其他公有鏈的節點，真的隨時能加入與退出。</span></p>

<p class=MsoListParagraph style='margin-left:18.0pt;text-indent:-18.0pt'><span
lang=EN-US>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"新細明體",serif'>降低技術門檻，所以很多事情會由</span><span
lang=EN-US>Pi Node Software</span><span style='font-family:"新細明體",serif'>來自動完成。</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span style='font-family:"新細明體",serif'>因此推測主網的</span><span
lang=EN-US>Quorum Set</span><span style='font-family:"新細明體",serif'>會透過某個機制來自動設定。所以固定</span><span
lang=EN-US>IP</span><span style='font-family:"新細明體",serif'>就不重要了嗎？因為</span><span
lang=EN-US>Pi</span><span style='font-family:"新細明體",serif'>帳號能對應到節點</span><span
lang=EN-US>IP</span><span style='font-family:"新細明體",serif'>，即使</span><span
lang=EN-US>IP</span><span style='font-family:"新細明體",serif'>改了也沒關係？</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span style='font-family:"新細明體",serif'>並非完全沒影響，要看每一家</span><span
lang=EN-US>ISP</span><span style='font-family:"新細明體",serif'>的政策，有些浮動</span><span
lang=EN-US>IP</span><span style='font-family:"新細明體",serif'>是</span><span
lang=EN-US>72</span><span style='font-family:"新細明體",serif'>小時換一次</span><span
lang=EN-US>(</span><span style='font-family:"新細明體",serif'>中華電信</span><span
lang=EN-US>)</span><span style='font-family:"新細明體",serif'>，有些只要你不主動斷線就不會換</span><span
lang=EN-US>(</span><span style='font-family:"新細明體",serif'>遠傳，而且短時間內再撥號，仍有可能取得相同的</span><span
lang=EN-US>IP)</span><span style='font-family:"新細明體",serif'>，有些可能是天天換。當你更換</span><span
lang=EN-US>IP</span><span style='font-family:"新細明體",serif'>時，路由器可能會立刻自動撥號，所以你的網路可能中斷不到</span><span
lang=EN-US>10</span><span style='font-family:"新細明體",serif'>秒鐘，你的節點在線率幾乎不受影響。但是如果你是</span><span
lang=EN-US>Validator</span><span style='font-family:"新細明體",serif'>，你的</span><span
lang=EN-US>IP</span><span style='font-family:"新細明體",serif'>換了，會有非常多節點的</span><span
lang=EN-US>Quorum Set</span><span style='font-family:"新細明體",serif'>必須調整，還是增加了一些不必要的工作出來。</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span style='font-family:"新細明體",serif'>所以固定</span><span
lang=EN-US>IP</span><span style='font-family:"新細明體",serif'>不是必要條件，但如果情況允許，使用固定</span><span
lang=EN-US>IP</span><span style='font-family:"新細明體",serif'>會更好。</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span style='font-family:"新細明體",serif'>另外，固定</span><span
lang=EN-US>IP</span><span style='font-family:"新細明體",serif'>、浮動</span><span
lang=EN-US>IP</span><span style='font-family:"新細明體",serif'>跟網路的穩定度也沒有關係，網路穩定度跟你用的</span><span
lang=EN-US>ISP</span><span style='font-family:"新細明體",serif'>、你家到機房的線路、你家自己的佈線及網路設備有關。</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span style='font-family:"新細明體",serif'>目前節點獎勵也跟固定</span><span
lang=EN-US>IP</span><span style='font-family:"新細明體",serif'>、浮動</span><span
lang=EN-US>IP</span><span style='font-family:"新細明體",serif'>沒有任何關係，很簡單的一個理由，有人告訴</span><span
lang=EN-US>Pi</span><span style='font-family:"新細明體",serif'>官方哪些</span><span
lang=EN-US>IP</span><span style='font-family:"新細明體",serif'>是固定給誰用、哪些</span><span
lang=EN-US>IP</span><span style='font-family:"新細明體",serif'>是大家輪流共用嗎？沒有啊！所以當一台節點上線後，憑什麼能判斷它是用固定</span><span
lang=EN-US>IP</span><span style='font-family:"新細明體",serif'>或浮動</span><span
lang=EN-US>IP</span><span style='font-family:"新細明體",serif'>？不可能！</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span style='font-family:"新細明體",serif'>再舉個例子，若用遠傳的浮動</span><span
lang=EN-US>IP</span><span style='font-family:"新細明體",serif'>，連線三個月都沒中斷過，跟中華電信固定</span><span
lang=EN-US>IP</span><span style='font-family:"新細明體",serif'>，但三天兩頭斷線或是沒開機，你說誰的獎勵會高？</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<span lang=EN-US style='font-size:12.0pt;font-family:"Calibri",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><a name="_Toc111928221"><span style='font-size:20.0pt;
font-family:"新細明體",serif'>七、為什麼開啟</span></a><span lang=EN-US style='font-size:
20.0pt'>API</span><span style='font-size:20.0pt;font-family:"新細明體",serif'>之後，本地區塊跟不上同步？</span></p>

<p class=MsoNormal><span style='font-family:"新細明體",serif'>網路上流傳一個說法，當本地區塊落後網路很多時，只要將</span><span
lang=EN-US>API Services</span><span style='font-family:"新細明體",serif'>關閉，就能趕上同步了，之後再將</span><span
lang=EN-US>API Services</span><span style='font-family:"新細明體",serif'>打開。沒有人知道為什麼，只是大家嘗試出來的方法，然後口耳相傳。我推測是因為機器的效能太差了。</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span style='font-family:"新細明體",serif'>先講一個重點，</span><span
lang=EN-US>SCP</span><span style='font-family:"新細明體",serif'>的點對點</span><span
lang=EN-US>(peer-to-peer)</span><span style='font-family:"新細明體",serif'>協議中，節點之間交換的只有「當前」區塊的</span><span
lang=EN-US>XDR</span><span style='font-family:"新細明體",serif'>資料，歷史資料一律都是由</span><span
lang=EN-US>History Archives</span><span style='font-family:"新細明體",serif'>下載</span><span
lang=EN-US>(</span><span style='font-family:"新細明體",serif'>此行為稱</span><span
lang=EN-US>Catchup)</span><span style='font-family:"新細明體",serif'>，下載後會先驗證其安全性，然後才寫入</span><span
lang=EN-US>Core DB</span><span style='font-family:"新細明體",serif'>及本地磁碟上的</span><span
lang=EN-US>XDR</span><span style='font-family:"新細明體",serif'>檔中</span><span
lang=EN-US>(</span><span style='font-family:"新細明體",serif'>稱為</span><span
lang=EN-US>Buckets)</span><span style='font-family:"新細明體",serif'>。</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span style='font-family:"新細明體",serif'>在目前的測試網中，大家的</span><span
lang=EN-US>History Archives</span><span style='font-family:"新細明體",serif'>都設定為</span><span
lang=EN-US>history.testnet.minepi.com</span><span style='font-family:"新細明體",serif'>這台機器，其負載可想而知。</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span style='font-family:"新細明體",serif'>我觀察了幾台節點的</span><span
lang=EN-US>stellar-core-stdout.log</span><span style='font-family:"新細明體",serif'>，發現一開始可能是某些原因</span><span
lang=EN-US>(CPU</span><span style='font-family:"新細明體",serif'>、</span><span
lang=EN-US>I/O</span><span style='font-family:"新細明體",serif'>、網路？</span><span
lang=EN-US>)</span><span style='font-family:"新細明體",serif'>造成共識失敗、有一些</span><span
lang=EN-US>Perf WARNING</span><span style='font-family:"新細明體",serif'>、</span><span
lang=EN-US>Out of sync</span><span style='font-family:"新細明體",serif'>，然後開始了</span><span
lang=EN-US>Catchup</span><span style='font-family:"新細明體",serif'>行為，以期望能趕上區塊。</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span style='font-family:"新細明體",serif'>可是</span><span
lang=EN-US>History Archives</span><span style='font-family:"新細明體",serif'>下載緩慢，下載完還要處理它，</span><span
lang=EN-US>Horizon</span><span style='font-family:"新細明體",serif'>又在一旁湊熱鬧，讓原本效能就不好的情況雪上加霜，最後區塊的落差越來越大，一直趕不上。</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span style='font-family:"新細明體",serif'>停掉</span><span
lang=EN-US>Horizon</span><span style='font-family:"新細明體",serif'>之後，</span><span
lang=EN-US>CPU</span><span style='font-family:"新細明體",serif'>跟</span><span
lang=EN-US>I/O</span><span style='font-family:"新細明體",serif'>都輕鬆多了，就能逐漸趕上區塊。所以問題可能還是在於機器的效能。</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span style='font-family:"新細明體",serif'>另外一提，</span><span
lang=EN-US>Horizon</span><span style='font-family:"新細明體",serif'>啟動時，並不是將</span><span
lang=EN-US>Core DB</span><span style='font-family:"新細明體",serif'>全部的資料都抓過來。</span><span
lang=EN-US>Stellar Core</span><span style='font-family:"新細明體",serif'>有一個</span><span
lang=EN-US>cursor</span><span style='font-family:"新細明體",serif'>用來保留資料不會被</span><span
lang=EN-US>Stellar Core garbage collection</span><span style='font-family:"新細明體",serif'>清除，如果</span><span
lang=EN-US>Horizon</span><span style='font-family:"新細明體",serif'>只是短暫停止再啟動停，就會從</span><span
lang=EN-US>cursor</span><span style='font-family:"新細明體",serif'>的地方開始讀；但如果停太久了，</span><span
lang=EN-US>cursor</span><span style='font-family:"新細明體",serif'>資料早已過期，或是第一次啟動</span><span
lang=EN-US>Horizon</span><span style='font-family:"新細明體",serif'>，就會從目前的區塊開始。</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<span lang=EN-US style='font-size:12.0pt;font-family:"Calibri",sans-serif'><br
clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><a name="_Toc111928222"><span style='font-size:20.0pt;
font-family:"新細明體",serif'>八、更改時區</span></a></p>

<p class=MsoNormal><span style='font-family:"新細明體",serif'>節點的</span><span
lang=EN-US>log</span><span style='font-family:"新細明體",serif'>位於</span><span
lang=EN-US> %appdata%\Pi Network\docker_volumes\supervisor_logs </span><span
style='font-family:"新細明體",serif'>，檔名為</span><span lang=EN-US>
stellar-core-stdout---supervisor-XXXXXX.log </span><span style='font-family:
"新細明體",serif'>，其中</span><span lang=EN-US>XXXXXX</span><span style='font-family:
"新細明體",serif'>是隨機產生的，每台節點的檔名都不一樣。</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span style='font-family:"新細明體",serif'>但裡面紀錄的時間是時區</span><span
lang=EN-US>UTC+0</span><span style='font-family:"新細明體",serif'>，跟台灣的時間差了</span><span
lang=EN-US>8</span><span style='font-family:"新細明體",serif'>小時，閱讀起來不是很方便，還要自己在腦袋中加</span><span
lang=EN-US>8</span><span style='font-family:"新細明體",serif'>小時，所以可以調整時區。</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span style='font-family:"新細明體",serif'>到</span><span
lang=EN-US>pi-consensus</span><span style='font-family:"新細明體",serif'>開</span><span
lang=EN-US>CLI</span><span style='font-family:"新細明體",serif'>，執行</span><span
lang=EN-US>sudo dpkg-reconfigure tzdata</span></p>

<p class=MsoNormal><span lang=EN-US><img border=0 width=554 height=385 id="圖片 9"
src="aboutnode.files/image013.jpg"></span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

</div>

</body>

</html>
